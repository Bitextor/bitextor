#!__ENV__ __PYTHON__

import sys
import argparse

oparser = argparse.ArgumentParser(description="Script that reads the output of bitextor pipeline and add stats from ILSP-FC")
oparser.add_argument('aligned_seg', metavar='FILE', nargs='?', help='File containing the set of aliged segments (if undefined, the script reads from the standard input)', default=None)
oparser.add_argument("-s", "--stats", help="Print stats or just output the input", action="store_true", dest="isPrintingStats", default=False)

options = oparser.parse_args()

if options.aligned_seg != None:
  reader = open(options.aligned_seg,"r")
else:
  reader = sys.stdin

for i in reader:
  fields = i.strip().split("\t")
  if options.isPrintingStats != False:
    lengthRatio=len(fields[2].decode('utf8'))*1.0/len(fields[3].decode('utf8'))
    numTokensSL=len(fields[2].split(' ')) #This is not the way this should be counted, we need to tokenize better first
    numTokensTL=len(fields[3].split(' ')) #This is not the way this should be counted, we need to tokenize better first
    fields.append(str(lengthRatio))
    fields.append(str(numTokensSL))
    fields.append(str(numTokensTL))
  print("\t".join(fields))


